//package dev.generators;
package examples.generators;

import java.math.BigInteger;
import java.io.BufferedWriter;
import java.io.OutputStreamWriter;
import java.io.FileOutputStream;
import java.io.Writer;
import java.io.IOException;

import circuit.eval.CircuitEvaluator;
import circuit.structure.CircuitGenerator;
import circuit.structure.Wire;
import circuit.structure.WireArray;
//import dev.gadgets.HashGadget;
//import examples.gadgets.hash.SHA256Gadget;
import examples.gadgets.math.LongIntegerModGadget;
import util.Util;
import circuit.auxiliary.*;

public class SetMemGenerator extends CircuitGenerator {

  public static final String uStr = "1090A91057A96B6750A00FD82540461FDD3B4158AF8EBBE1960B2FBD3DB35F46FC28CF480704F269A3488082F1C39AC530ACDE8012553D656B6A7C3E97CA708432587BC092BCA3AC7C0A3859BE0D08DDF8F01F8C5320B7F057AAB9E22A1EC96B099DE8A18034396C340FCC5FC6A522CD403ADC299AE4A4AF94A735518A3870B29E54A4FAFEE895440FDFE1B786A90385A4ED91F35D2F1F9F7BA11D4A0357A5BEF5221877680986829A1D5714766BCE0DF589BDC1C01A702C35BD979379BBBA6C6543701DCEB8A5C3A975EE3AF84808EB58750E6785948039DA5D501FBB6C5F51EA6A3B8FCBF443EFA4B13F5108A01D795F7EB2E7D8C942760C4D833F3BF841884ABB52DC69D971F7F5F0D1E62D0EAA938C38336DC96793D19824D1A84E4BF8517D5A7FBC288B8BFDB8F93A0319A028B89D4C5297BB0C2B8A5349293FEBA6167EC8CCADACF676AC1923C70BDFD965316DA5121967E6D7E9452DEC08282B20A337363375DE824804463EA87DD151B4D28287F1C0B9C6262C5258220ED6EBA1798D914B721BE6CE7014A04C2843C9B25F2BE4812BBB4D87F20F7A3F2DA5D6DAEF1C5FDAE57D60FE0F3808220A1ECDD10BD70D0305AA2FE13F6E3FB4E1A27DDF2BD4C041DCE06B19DE8A095C1A40C83D044A31E9E718AA344BBA23479CF882A717156263CC190C8CCA90F3F80E6A4A7501A4D005D7E7D685C14C3CC9B00D7B8DB5E26A21E18C3DA181989AEBB3B2F5ECA7808BEFC5C9CFF0961F3CFE657A7F5CB28763F2188ED9520981B1B581B45F759EB1027A8788BFB8FE28CAAF9B0710F057E321E48DB08E37E2C9C276D39693CE63BC2E517268ABE31920C20DA3CD0C3EBE146DAADB696E9D6CE32FAB7373E9B5B2240D76BDA944D25035686475BEA5177798B65293AB6D3A8450A169F02739F2CD842C46E3C41BECA71D6EA589F5341DF818ED745B9B0844A9295E90D6B7513B8C0A8F021CBC39E7FB81E3A0A008A88C3F89BD983B163E4622164ED4D7D73E26CC5B42DBE308CDAB33136E7BF0A85E0F88B6272058F321B909FAE64CB64661735AFAECC3BEC47B3DBCEBA66EDAFF5F834B679E641ACB72662CCA378387DB0EFA9E6AA458683BAFC747D110411DA465926647F2CB9FFB69554781EF9A70AA8F3CFB129499994F78458B5812490072718D394658D9D9D62DADEE243D923A1CC5F73785CB75AE18B9A8B009A822597A06A43F973E163DA33255827A631C21269A3027DB7BB8D1FEC49A9403EE2D05F38AA0CDC909E26A6BE587262B7F8E6D97B070E2D6E08AB9AC3BBDB79A521495DCD7B8323599C8E2FCE85AC69E6767C5253CA3584E9DBBC9DF8938A1DBEC5A5AC38EB0D86AC6CC20CB9268DD18A303BCAC79BF10C7FBB3A033B05BA7DAB217CDE5DB30B242C9A2C820A985E02600991B88E7B43B4BB6D94BC80136A303012595E1951C076C636402012AAC8A8655E1BF70C783D832E3529EDC52AABC2AC9B0B528709B989DD27A3FB80CEC5629E7F4DE7D23E3D01654069226B208480CB90416D0384CB8C4CB2870E458130EF6387105DF27382E924B6313EDA4C90CDD61CBFC8976ECFBBA167EF8422EFB3791CC311544957F9D0DBE696E61D0254EF56B607EB4FDDABFF62C2378ACB5D0A6F9DF8BEC39A2E4A5EC6347AE25D6CF49E62E4FC48584CF0F1DA8F01F887641150793749EFB20A5E9C84614F1B69A935FB62B671EE3E14CC0A5FDA8DC134888302F87EAF7DFB7C20B60E21B0D8A404F07BDE174E3013FF4F762CF01F1617079D0CE559FE43A0CC9E1957D9109702F4B14C631845B56F39C76E70F35E7DFEAE3A59467EBA6B1ED5FB36D368C0F8884EF8073591B724F420D0829B05069D95AE4A2C055B49FBC9BAF7C15B7DF14FBE8ED149679F09F9B54B93E059671890D8DCE3F1B53385863E740FF02846A6E72C6C129749F537FCE19177FC465D515426D7986847CA035BE3D9E57EB8C224CB21AF76B210E8C0C29417E7DE3502666F61B54DAD062CEFBBD875346B4BF6A252A4DC98B449AA4F95043240EC11835BF2E10A9CEB2244DD74F44B45D62E50A6D462B9DD26EB3980F3A647CC60A49D90BB01E9600191EA8BCBDD0B862FFDF1DFA403F6DAF3241E8E5FD02A67FA30F8C31E90EB8BC66EEF24402E682A0274DD08FDD71D91530C3CAFEC379E449E51DC70F0754A466589FF3DE2FC7DD962988B43E5A234CF23980CABF63D356D3C0F1498339E948E178AC198BE93258717A33B9271DE07026800CDB9736E94939E7D2FEDCCEDC36347CD931CE59D06983717F22BD8885E597BAC1F4E061384A3D325422CEF8E660BEF801EA3CFD12C4F0B223AF3F51B952657381FDBB67B7C32A31C123E9D20705F21EFDA25D6012F9181C501F7C6EAC6E52B290A88D93788F645C3835A8716BB31FA5684E8AE929D945E1031159BCD2AFCCC7C96919EBF463C405ABF28F393992E7B295575F2DC467DB41FE423BD763D090BEC32972E81388655D5757CEEAFC1C20A1781DADB8A995CA7E65A42D3A6A67E5684CAB95B557B4F8F1B4FF6AE1E4D50007E35FF2BFCA55D52C07DF2F655495A668E804FB0BD518DEC253443473B851FB1095BB74D3DD62288E405F23624FF17B44394C05B35901C1BE0800DDACFEC75AB2A33E9564AC1D266BC09411F57A2F47011B3F3C15C52A1A9C82EC6221F5442CCEE4E039901FB098FDB1DCD05844958B2E20270B6FBC8E2B96055D125A37B2A0DF20F5DFC5800CD37F5BB822677565CAA9CCFBA377AFCE6D17603CCE5D1F7F92065942E709E25BA2C9581675A7E415B9A586ABDB1E1837953979FFEA86F5B7223C0811550F95420348748D9BC19381385ACFB7084F9B51DEBA3908FDB16F7131BD2E749430AE0000000000000000";

  public static final String hStr = "E7FFE0FAA3F5ED9F6380C927B19C18A335EAD05ABCBB9FC711732C6F2C4A214B";

  public static final String sStr = "EB4D1A85235DBD8B8A28076E7EA7C20338D48E428372216F233B4D551FDB74C608E7C309C1D688A7DDC4D0F71A6C45E8B78B1342EEF2424C7034135FE9EA36E78A27D9872407642E2D94EED176D33A6D6C94614D4974398629CC4F914579FD581BC8449B178C97DF5758E493E5409DD9AC3FA3610BE32B987B60763A549A7ADC1A177CE6E8067565CDB5F9922B8D58E9ADC4C5468015EB4D1A85235DBD8B8A28076E7EA7C20338D48E428372216F233B4D551FDB74C608E7C309C1D688A7DDC4D0F71A6C45E8B78B1342EEF2424C7034135FE9EA36E78A27D9872407642E2D94EED176D33A6D6C94614D4974398629CC4F914579FD581BC8449B178C97DF5758E493E5409DD9AC3FA3610BE32B987B60763A549A7ADC1A177CE6E8067565CDB5F9922B8D58E9ADC4C5468015EB4D1A85235DBD8B8A28076E7EA7C20338D48E428372216F233B4D551FDB74C608E7C309C1D688A7DDC4D0F71A6C45E8B78B1342EEF2424C7034135FE9EA36E78A27D9872407642E2D94EED176D33A6D6C94614D4974398629CC4F914579FD581BC8449B178C97DF5758E493E5409DD9AC3FA3610BE32B987B60763A549A7ADC1A177CE6E8067565CDB5F9922B8D58E9ADC4C5468015";

  public static final String ustr =   "1D4DE395CEB5F32CEBE96DC75E1BDF2651892C42DF169F0785D3D386E3181211016457DCF85385C3F3E54359FE63513E82CDD227E47E0916097E42CF1221E30B05803932CE4A909EA6E13CE5EEF8C83D2241A595D75F74C8FAFF9A0737E78F9BF6917A914D756CFCA3A339CC3FC39732DC2C90F27CF6B022741FF1058B13BA2F606D64179DBFA313F4C0678B7C49DD8764C8BD2398AD7A3DAFEFB14821483E443B10D73F7DED74D2A124D044504BAC1CD71B12BBC29F58B494E88C2164882EA8D27A291EE70EFE3738526BF70B892C1E42521C25063274F36410E29BC1211D08D8C2A11EEFC50C86D3BF3D035FECAF5B93A8B9FB7BBCEE0361F14357156178BD9E0081AAC96E803924271C2446C878B8DC577461F07DC5B0EA465A13D5C15CAEC26A61053F91DD77D587B53934398B0D6CD25DEAEDE444B3FE8C4D80614944592F940DE264271FE28E3B700EF7900D2F975719A0431C22BCFD51C482EDCAD65A6D40EE30B469957AAB767F28DB69553889D0208D6881CFF25F177BDDA7CEF61A598F3A5A4A8D934D31D2D404F39737BA01639F998C144FFEAC22969A2893F25D0A819E23C7521231BC15D217E9C84CC0BA12E6879BB1232438E5AFF6A50D499444ABBFDB9CF4BEC130B2295704ACEC171EED028622CB043CCEEF8CD6231CF7902F6706E9F148EC6471524B259CEEE041EDA159E2C49F0EA229C0B3EC28DFACFBD203616A91A8E31CBD8FAF01BB65DA98CA813CA071841569EFD6B356E81982EC990568F88470C67D460A5DFB6BCACFCBB0A7CB8793190666E9B4102A194253802A5689F044D62C9CD8E84893EDF064741321DEA6EAC6BC32D6117899702D67F343B67BDE40547F0F5809131D02D6C5D58EE2A684196EBD5DDAC959433E0A8EDED1E75DACEF4ECE4791BBC1E827CA451BA64B753A3787D67B163DF2AADA6782329F2272B9355E4AA30A98911DE81BE9DEC4A9B5DE632E3A2C5F31E450C42C7111F0EC5B0DAE3DA5F587CAB11C65DA586FF7C3271BE22C88DEC01433AA9F81034D3CCE0C5E5A39E2AC5647ED9553F0BBB8BD054C9E2C99009AEFDD22108849494B8D74FE37E935DB1EBC8600AA25E9ABEBCBF39CEFDA5DF6EAA439B014E67694C0B77D7B6DCC2D3F9EF2B70BDBD8461A4AD364163B52D86126AD3B82BF44285FC881FBA2F39AFD1E0E4A7405E80E9726B3A417607C4076580AD7D513028012D301466822475F785D612E10884C411DFFA71B6798A38C0BB38BAFDAA10876C7753D74C2A84FF75305D98A76D141CD89517FA0EF838F4FF3604856D1DD68BDA0F39DC28B4F5C77D42E0E26CF1D3BB8DAB24CBAEC900300A4E83D365C094C8627787C3A9469537F2C9EB14446E8553C7C22166CDEB849EA080DBF83123A6357F374F5472CB19272591376259E36D9C7293BCB5D1363F4718B00BD0F94658C5AAD001D0AE33127F3543DFFA0387E655E8A3CD8000A99432DA4080A774B57905660759383584CE53FD214A14C973B6AD4A9CF12F95E922854F531DB64E3F5EE70476A0FFBACA117C0955CF422649C027499EDABB4D126DF0D987B389F6194753F5E8CED0E8D2F0D81EF7542DD7FF06235CEBBEAB0A8F978E320B94C2EAA4B9326A11BBF3CD1769024211B2456D89C8EDFBD75FAE03166F7611C415FACD5214696CCD54615D120B78D07C31D8E68C59E51EBE45870F8D3868BD680047BEAB31E04E771C17821733C76017A24A8DC2C95F336D65C50C63252CDC1A87FBA28468412337552CDFFF1730C8802F3DA332CB6C9D87E8926F8F4454D7926637B232A52A1CE48CAF50B8FFD6294DE5A07A16FABA8E96715F12F66F4614B04F0E55673D4369FDBDB4D0FD2E650030FFBCCE3C1FD19C853EA7C86F3EB2F4A4644DE2F0149EC4FE42B037955213C2F99975DEF55DD3E471A1B980918A05723DB48EEDE3C562DC1DEF90F818B8CA855D9443FD4BB1F3B93DBEC34E0EB42201123EBF8DA46099877314633635E19AD5A6C626B8260D47934716BE540B30AC3742568B35F8971AE297701934F6E1FF9962EFD12633FA4447EE13DFAC92B4ECF05E1306663B154A8C75FB151C2C3AA596E171224E9124AAA71045403301C1206654992F9BA31804F74F384857CF5296AD802B110446892EF4F8D3FB8F1B45EC35A125FF39335E476B36491E743092F83A0D40E33141E4CEF682B691AC1845B785801241FF5712E9949FBDADDEBD7B9CE9092B0E5C973A9294020B276A8BF0E76AC26D422DD41549A5F2CC85CFF5F7DB369FE0A7C72E8437A8B4154C864DC787BB2DEFA63D2623CD8A6537592581AC1B935F8069DC963290E7D95FCA4A190CEDD0EE8492FA7CC7949A02BD98440DE3D564DE9BDB4C4A36973D82B2B46F7E2F47D71E1E760724C23333AB69D243C416C6747A179D6190F550D6E603E2899D672A4350AB40B8BD5FDC9039EA092057813D0EF3BEB11A32A3734B22C779E0C0DE520A48B56205C38BF8E2A9ECF4BC5A37979B9A8FE5A6495419A25CF1DC832C669591060F9BD6C69D2FB4554F415FCD17F38A59703D0AF4D2182920EF06FE6B7AF6D99AE3ABBD1EF1BF13D75AAD021FD8D6378B835A259AE33901850562A25EC7469DE1FF8D67B7A12DAB470175B2108C3DB09245D89D7DF65C3613CF038733B319E1CF772A218FA255FFA8B58610EB2713AF711147A7C993B3A49B4AC1248967F48989A2AFE89F070BC0CF9BA748B9207617F62280CC655DE57F02F134DF0ACF336AF7169BF003F114D259E42D51A4F55165450A38D4095D17DA960E2063F1625D92F2E0D2A144B0DC20A17F240698BFE8999C2D50D9B9F7F1122FA4A6A89875088BF4C7C571072C043B85A92ABC9DBE92A16572257F827FBF9C7F8AD30CA422795BBF62E157F07078B748A93CF9C74FEA4AEBAD2C2A5A19E53114FA8C6F30D9B0091CA2C37B57D2046F435CFF53BB0353757D9E529777866E1D036C504A491151C5681CD9F8B83400C747BD3BDE575367AC288E8993B44DAB19173660755432096B1E4E6D90212DB1014D8E170E303A42091795AFA8453E9151CAB4529B1272B51C6B8C4A7FDBFADF1D34780E03EAAC8594FED8BE3B5DE957CB6370C8F919A4A0B82EE31829A52DDC62B2643DDDD2740EC706ACC6C6BF8";


  public static final String rStr = "1D4DE395CEB5F32CEBE96DC75E1BDF2651892C42DF169F0785D3D386E3181211016457DCF85385C3F3E54359FE63513E82CDD227E47E0916097E42CF1221E30B05803932CE4A909EA6E13CE5EEF8C83D2241A595D75F74C8FAFF9A0737E78F9BF6917A914D756CFCA3A339CC3FC39732DC2C90F27CF6B022741FF1058B13BA2F606D64179DBFA313F4C0678B7C49DD8764C8BD2398AD7A3DAFEFB14821483E443B10D73F7DED74D2A124D044504BAC1CD71B12BBC29F58B494E88C2164882EA8D27A291EE70EFE3738526BF70B892C1E42521C25063274F36410E29BC1211D08D8C2A11EEFC50C86D3BF3D035FECAF5B93A8B9FB7BBCEE0361F14357156178BD9E0081AAC96E803924271C2446C878B8DC577461F07DC5B0EA465A13D5C15CAEC26A61053F91DD77D587B53934398B0D6CD25DEAEDE444B3FE8C4D80614944592F940DE264271FE28E3B700EF7900D2F975719A0431C22BCFD51C482EDCAD65A6D40EE30B469957AAB767F28DB69553889D0208D6881CFF25F177BDDA7CEF61A598F3A5A4A8D934D31D2D404F39737BA01639F998C144FFEAC22969A2893F25D0A819E23C7521231BC15D217E9C84CC0BA12E6879BB1232438E5AFF6A50D499444ABBFDB9CF4BEC130B2295704ACEC171EED028622CB043CCEEF8CD6231CF7902F6706E9F148EC6471524B259CEEE041EDA159E2C49F0EA229C0B3EC28DFACFBD203616A91A8E31CBD8FAF01BB65DA98CA813CA071841569EFD6B356E81982EC990568F88470C67D460A5DFB6BCACFCBB0A7CB8793190666E9B4102A194253802A5689F044D62C9CD8E84893EDF064741321DEA6EAC6BC32D6117899702D67F343B67BDE40547F0F5809131D02D6C5D58EE2A684196EBD5DDAC959433E0A8EDED1E75DACEF4ECE4791BBC1E827CA451BA64B753A3787D67B163DF2AADA6782329F2272B9355E4AA30A98911DE81BE9DEC4A9B5DE632E3A2C5F31E450C42C7111F0EC5B0DAE3DA5F587CAB11C65DA586FF7C3271BE22C88DEC01433AA9F81034D3CCE0C5E5A39E2AC5647ED9553F0BBB8BD054C9E2C99009AEFDD22108849494B8D74FE37E935DB1EBC8600AA25E9ABEBCBF39CEFDA5DF6EAA439B014E67694C0B77D7B6DCC2D3F9EF2B70BDBD8461A4AD364163B52D86126AD3B82BF44285FC881FBA2F39AFD1E0E4A7405E80E9726B3A417607C4076580AD7D513028012D301466822475F785D612E10884C411DFFA71B6798A38C0BB38BAFDAA10876C7753D74C2A84FF75305D98A76D141CD89517FA0EF838F4FF3604856D1DD68BDA0F39DC28B4F5C77D42E0E26CF1D3BB8DAB24CBAEC900300A4E83D365C094C8627787C3A9469537F2C9EB14446E8553C7C22166CDEB849EA080DBF83123A6357F374F5472CB19272591376259E36D9C7293BCB5D1363F4718B00BD0F94658C5AAD001D0AE33127F3543DFFA0387E655E8A3CD8000A99432DA4080A774B57905660759383584CE53FD214A14C973B6AD4A9CF12F95E922854F531DB64E3F5EE70476A0FFBACA117C0955CF422649C027499EDABB4D126DF0D987B389F6194753F5E8CED0E8D2F0D81EF7542DD7FF06235CEBBEAB0A8F978E320B94C2EAA4B9326A11BBF3CD1769024211B2456D89C8EDFBD75FAE03166F7611C415FACD5214696CCD54615D120B78D07C31D8E68C59E51EBE45870F8D3868BD680047BEAB31E04E771C17821733C76017A24A8DC2C95F336D65C50C63252CDC1A87FBA28468412337552CDFFF1730C8802F3DA332CB6C9D87E8926F8F4454D7926637B232A52A1CE48CAF50B8FFD6294DE5A07A16FABA8E96715F12F66F4614B04F0E55673D4369FDBDB4D0FD2E650030FFBCCE3C1FD19C853EA7C86F3EB2F4A4644DE2F0149EC4FE42B037955213C2F99975DEF55DD3E471A1B980918A05723DB48EEDE3C562DC1DEF90F818B8CA855D9443FD4BB1F3B93DBEC34E0EB42201123EBF8DA46099877314633635E19AD5A6C626B8260D47934716BE540B30AC3742568B35F8971AE297701934F6E1FF9962EFD12633FA4447EE13DFAC92B4ECF05E1306663B154A8C75FB151C2C3AA596E171224E9124AAA71045403301C1206654992F9BA31804F74F384857CF5296AD802B110446892EF4F8D3FB8F1B45EC35A125FF39335E476B36491E743092F83A0D40E33141E4CEF682B691AC1845B785801241FF5712E9949FBDADDEBD7B9CE9092B0E5C973A9294020B276A8BF0E76AC26D422DD41549A5F2CC85CFF5F7DB369FE0A7C72E8437A8B4154C864DC787BB2DEFA63D2623CD8A6537592581AC1B935F8069DC963290E7D95FCA4A190CEDD0EE8492FA7CC7949A02BD98440DE3D564DE9BDB4C4A36973D82B2B46F7E2F47D71E1E760724C23333AB69D243C416C6747A179D6190F550D6E603E2899D672A4350AB40B8BD5FDC9039EA092057813D0EF3BEB11A32A3734B22C779E0C0DE520A48B56205C38BF8E2A9ECF4BC5A37979B9A8FE5A6495419A25CF1DC832C669591060F9BD6C69D2FB4554F415FCD17F38A59703D0AF4D2182920EF06FE6B7AF6D99AE3ABBD1EF1BF13D75AAD021FD8D6378B835A259AE33901850562A25EC7469DE1FF8D67B7A12DAB470175B2108C3DB09245D89D7DF65C3613CF038733B319E1CF772A218FA255FFA8B58610EB2713AF711147A7C993B3A49B4AC1248967F48989A2AFE89F070BC0CF9BA748B9207617F62280CC655DE57F02F134DF0ACF336AF7169BF003F114D259E42D51A4F55165450A38D4095D17DA960E2063F1625D92F2E0D2A144B0DC20A17F240698BFE8999C2D50D9B9F7F1122FA4A6A89875088BF4C7C571072C043B85A92ABC9DBE92A16572257F827FBF9C7F8AD30CA422795BBF62E157F07078B748A93CF9C74FEA4AEBAD2C2A5A19E53114FA8C6F30D9B0091CA2C37B57D2046F435CFF53BB0353757D9E529777866E1D036C504A491151C5681CD9F8B83400C747BD3BDE575367AC288E8993B44DAB19173660755432096B1E4E6D90212DB1014D8E170E303A42091795AFA8453E9151CAB4529B1272B51C6B8C4A7FDBFADF1D34780E03EAAC8594FED8BE3B5DE957CB6370C8F919A4A0B82EE31829A52DDC62B2643DDDD2740EC706ACC6C6BF81D4DE395CEB5F32CEBE96DC75E1BDF2651892C42DF169F0785D3D386E3181211016457DCF85385C3F3E54359FE63513E82CDD227E47E0916097E42CF1221E30B05803932CE4A909EA6E13CE5EEF8C83D2241A595D75F74C8FAFF9A0737E78F9BF6917A914D756CFCA3A339CC3FC39732DC2C90F27CF6B022741FF1058B13BA2F606D64179DBFA313F4C0678B7C49DD8764C8BD2398AD7A3DAFEFB14821483E443B10D73F7DED74D2A124D044504BAC1CD71B12BBC29F58B494E88C2164882EA8D27A291EE70EFE3738526BF70B892C1E42521C25063274F36410E29BC1211D08D8C2A11EEFC50C86D3BF3D035FECAF5B93A8B9FB7BBCEE0361F14357156178BD9E0081AAC96E803924271C2446C878B8DC577461F07DC5B0EA465A13D5C15CAEC26A61053F91DD77D587B53934398B0D6CD25DEAEDE444B3FE8C4D80614944592F940DE264271FE28E3B700EF7900D2F975719A0431C22BCFD51C482EDCAD65A6D40EE30B469957AAB767F28DB69553889D0208D6881CFF25F177BDDA7CEF61A598F3A5A4A8D934D31D2D404F39737BA01639F998C144FFEAC22969A2893F25D0A819E23C7521231BC15D217E9C84CC0BA12E6879BB1232438E5AFF6A50D499444ABBFDB9CF4BEC130B2295704ACEC171EED028622CB043CCEEF8CD6231CF7902F6706E9F148EC6471524B259CEEE041EDA159E2C49F0EA229C0B3EC28DFACFBD203616A91A8E31CBD8FAF01BB65DA98CA813CA071841569EFD6B356E81982EC990568F88470C67D460A5DFB6BCACFCBB0A7CB8793190666E9B4102A194253802A5689F044D62C9CD8E84893EDF064741321DEA6EAC6BC32D6117899702D67F343B67BDE40547F0F5809131D02D6C5D58EE2A684196EBD5DDAC959433E0A8EDED1E75DACEF4ECE4791BBC1E827CA451BA64B753A3787D67B163DF2AADA6782329F2272B9355E4AA30A98911DE81BE9DEC4A9B5DE632E3A2C5F31E450C42C7111F0EC5B0DAE3DA5F587CAB11C65DA586FF7C3271BE22C88DEC01433AA9F81034D3CCE0C5E5A39E2AC5647ED9553F0BBB8BD054C9E2C99009AEFDD22108849494B8D74FE37E935DB1EBC8600AA25E9ABEBCBF39CEFDA5DF6EAA439B014E67694C0B77D7B6DCC2D3F9EF2B70BDBD8461A4AD364163B52D86126AD3B82BF44285FC881FBA2F39AFD1E0E4A7405E80E9726B3A417607C4076580AD7D513028012D301466822475F785D612E10884C411DFFA71B6798A38C0BB38BAFDAA10876C7753D74C2A84FF75305D98A76D141CD89517FA0EF838F4FF3604856D1DD68BDA0F39DC28B4F5C77D42E0E26CF1D3BB8DAB24CBAEC900300A4E83D365C094C8627787C3A9469537F2C9EB14446E8553C7C22166CDEB849EA080DBF83123A6357F374F5472CB19272591376259E36D9C7293BCB5D1363F4718B00BD0F94658C5AAD001D0AE33127F3543DFFA0387E655E8A3CD8000A99432DA4080A774B57905660759383584CE53FD214A14C973B6AD4A9CF12F95E922854F531DB64E3F5EE70476A0FFBACA117C0955CF422649C027499EDABB4D126DF0D987B389F6194753F5E8CED0E8D2F0D81EF7542DD7FF06235CEBBEAB0A8F978E320B94C2EAA4B9326A11BBF3CD1769024211B2456D89C8EDFBD75FAE03166F7611C415FACD5214696CCD54615D120B78D07C31D8E68C59E51EBE45870F8D3868BD680047BEAB31E04E771C17821733C76017A24A8DC2C95F336D65C50C63252CDC1A87FBA28468412337552CDFFF1730C8802F3DA332CB6C9D87E8926F8F4454D7926637B232A52A1CE48CAF50B8FFD6294DE5A07A16FABA8E96715F12F66F4614B04F0E55673D4369FDBDB4D0FD2E650030FFBCCE3C1FD19C853EA7C86F3EB2F4A4644DE2F0149EC4FE42B037955213C2F99975DEF55DD3E471A1B980918A05723DB48EEDE3C562DC1DEF90F818B8CA855D9443FD4BB1F3B93DBEC34E0EB42201123EBF8DA46099877314633635E19AD5A6C626B8260D47934716BE540B30AC3742568B35F8971AE297701934F6E1FF9962EFD12633FA4447EE13DFAC92B4ECF05E1306663B154A8C75FB151C2C3AA596E171224E9124AAA71045403301C1206654992F9BA31804F74F384857CF5296AD802B110446892EF4F8D3FB8F1B45EC35A125FF39335E476B36491E743092F83A0D40E33141E4CEF682B691AC1845B785801241FF5712E9949FBDADDEBD7B9CE9092B0E5C973A9294020B276A8BF0E76AC26D422DD41549A5F2CC85CFF5F7DB369FE0A7C72E8437A8B4154C864DC787BB2DEFA63D2623CD8A6537592581AC1B935F8069DC963290E7D95FCA4A190CEDD0EE8492FA7CC7949A02BD98440DE3D564DE9BDB4C4A36973D82B2B46F7E2F47D71E1E760724C23333AB69D243C416C6747A179D6190F550D6E603E2899D672A4350AB40B8BD5FDC9039EA092057813D0EF3BEB11A32A3734B22C779E0C0DE520A48B56205C38BF8E2A9ECF4BC5A37979B9A8FE5A6495419A25CF1DC832C669591060F9BD6C69D2FB4554F415FCD17F38A59703D0AF4D2182920EF06FE6B7AF6D99AE3ABBD1EF1BF13D75AAD021FD8D6378B835A259AE33901850562A25EC7469DE1FF8D67B7A12DAB470175B2108C3DB09245D89D7DF65C3613CF038733B319E1CF772A218FA255FFA8B58610EB2713AF711147A7C993B3A49B4AC1248967F48989A2AFE89F070BC0CF9BA748B9207617F62280CC655DE57F02F134DF0ACF336AF7169BF003F114D259E42D51A4F55165450A38D4095D17DA960E2063F1625D92F2E0D2A144B0DC20A17F240698BFE8999C2D50D9B9F7F1122FA4A6A89875088BF4C7C571072C043B85A92ABC9DBE92A16572257F827FBF9C7F8AD30CA422795BBF62E157F07078B748A93CF9C74FEA4AEBAD2C2A5A19E53114FA8C6F30D9B0091CA2C37B57D2046F435CFF53BB0353757D9E529777866E1D036C504A491151C5681CD9F8B83400C747BD3BDE575367AC288E8993B44DAB19173660755432096B1E4E6D90212DB1014D8E170E303A42091795AFA8453E9151CAB4529B1272B51C6B8C4A7FDBFADF1D34780E03EAAC8594FED8BE3B5DE957CB6370C8F919A4A0B82EE31829A52DDC62B2643DDDD2740EC706ACC6C6BF8";

    private static String[] args;
    // Non-opt membership elements
    // private LongElement long_k, long_r, long_s, long_u, long_h;

    // Opt Membership elements
    private LongElement long_opt_k, long_opt_r, long_opt_s, long_opt_u, long_opt_h, long_opt_l;
    private Wire[] sk;
    //private SHA256Gadget sha2Gadget;

    private int batchSize;
    private int bitsize_k, bitsize_r, bitsize_s, bitsize_u, bitsize_h;

    public static final int bitsizeProd128Primes = 1300; // worst case product for 128 primes: largest 128 primes
    public static final int bitsizeProdFirst256Primes = 2290; // super worst case: all primes


    public SetMemGenerator(String circuitName, int batchSize) {
        super(circuitName);
        this.batchSize = batchSize;

        bitsize_h = 256;

        bitsize_u = 256*batchSize;
        bitsize_s = bitsizeProdFirst256Primes;
        bitsize_r = bitsize_s+bitsize_h+bitsize_u+128;
        bitsize_k = bitsize_r+1;

    }

    public BigInteger getInputFromString(int bitsize, String s)
    {
      int nHexChars = bitsize/4;
      while( s.length() < nHexChars) {
        s = s + s;
      }
      String trimmedStr = s.substring(0, nHexChars);
      return new BigInteger(trimmedStr, 16);
    }



    @Override
    protected void buildCircuit() {
        long_opt_h = createLongElementInput(bitsize_h);
        long_opt_s = createLongElementInput(bitsize_s);
        long_opt_u = createLongElementInput(bitsize_u);

        long_opt_r = createLongElementInput(bitsize_r);
        long_opt_k = createLongElementInput(bitsize_k);

        //long_opt_l = createLongElementInput(new BigInteger("17361E1DB434756DFA4C757E10F320BF5C914D66BEE172343232BB5DB51E8BA9", 16).bitLength());


        // NB: current code is not doing modular exponentation
        LongElement tmp1 = long_opt_u.mul(long_opt_s).mul(long_opt_h);
        LongElement tmp2 = long_opt_r.add(tmp1); // alleged k value

        long_opt_k.assertEquality(tmp2);



        //LongElement tmp3 = new LongIntegerModGadget(tmp2, long_opt_l, 0, false).getRemainder();

/*
        sk = createInputWireArray(64);
        sha2Gadget = new SHA256Gadget(sk, 8, 64, false, false);
        Wire[] digest = sha2Gadget.getOutputWires();
        makeOutputArray(digest);
*/
    }


    @Override
    public void generateSampleInput(CircuitEvaluator circuitEvaluator) {

        BigInteger rVal, uVal, sVal, hVal, kVal;
        rVal = getInputFromString(bitsize_r, rStr);
        sVal = getInputFromString(bitsize_s, sStr);
        hVal = getInputFromString(bitsize_h, hStr);
        uVal = getInputFromString(bitsize_u, uStr);
        kVal = rVal.add(sVal.multiply(uVal.multiply(hVal)));


        circuitEvaluator.setWireValue(long_opt_k, kVal, LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_opt_r, rVal, LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_opt_u, uVal, LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_opt_s, sVal, LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_opt_h, hVal, LongElement.CHUNK_BITWIDTH);
        //circuitEvaluator.setWireValue(long_opt_l, new BigInteger("17361E1DB434756DFA4C757E10F320BF5C914D66BEE172343232BB5DB51E8BA9", 16), LongElement.CHUNK_BITWIDTH);


        /*
        circuitEvaluator.setWireValue(long_k, new BigInteger("0AC8A70F130DD874DA8BF72D5864FEDF134E1866971015266D278720D3264290264F21796F69074CDFE7ACC5BF892E02D51F2934B7421AF0E31853918E9F7921BED6A9161FBFFECF8AD46D9A96A1EFD1F85F29D3CA41FBF98D8DE5BE78D3A5C037A2C663C233B5C1FC6AB9C500D9AFB986A824568498E1092BFF3C8126BDE7BE156C2DB9431D56EEB7D4BA0D285B28357FB1C201F44E784D8AB20C3785901A5FC50845CD3357BC07F06C671430CE9619608CEA06CC0A327D5F57FDA9E983A4A09B4DE3498A968E503198CF740C475F8C29DF", 16), LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_r, new BigInteger("07E92251B148678141FA41EF5CD32F58B83D5039DEE0C98859DCD02B925CEC1E50597E0A1D1081A945A5B157DC5820BDC5853C812ADD30C10A3B5F38EB1431625BF7217A4B98F9F989F413E13B0459DD23E49BE8474BE1DA8FFE10A8AE541764D8C229115BE5B8582AD940A3A9778C61DEBF896330D4A9345F9F2D0707F1FABA0C2E6B5BAA08E0B1D6030C6FBFE4E8EE17E73E391704565682FE53FC68E4CF41C3D05CA4A8300C17CCE0E6F25C147615DDCE5BDEF9D8007C2956EE4780B9AA6EB5236B0804D0F9CCC02D59ECD8DE136BBDD7", 16), LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_u, new BigInteger("A2304B2645E5984DAED4A18F1ABA5D803E42C3860CA8B671692305EBA3B68FA3", 16), LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_s, new BigInteger("06A6856769863A073CFDBAAE090228597136F31AE77F27F250CC1EC3C849AA419CDA089F979049F55CB36D390CFC8076785D87CCE4DF872DC8E43E46778F6906CAC2351B1DF16C995B2D7D592C41F17E1ED9AA11CB239F22DC0C0D676229BA1AE1375220AFABE42435A5FD1291BC665B5735DD453FDD918DAABCB486170368EA0EF9954C56FC749D872901F0595014212815", 16), LongElement.CHUNK_BITWIDTH);
        circuitEvaluator.setWireValue(long_h, new BigInteger("AE90FDB7A7319015B561E3E479C96D56FF4727F6E610D804914F782239A7F0F8", 16), LongElement.CHUNK_BITWIDTH);
    */

        /*
        String inputStr = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijkl";
		for (int i = 0; i < sk.length; i++) {
			circuitEvaluator.setWireValue(sk[i], inputStr.charAt(i));
		}
        */
    }

    public static void main(String[] args) throws Exception {
        /*
        if (args.length != 6) {
            System.out.println("Invalid Input Length");
            System.exit(1);
        }
        */
        SetMemGenerator.args = args;
        int batchSize = 10;
        if (args.length > 0) {
          batchSize = Integer.parseInt(args[0]);
        }
        SetMemGenerator generator = new SetMemGenerator("setmem" + batchSize, batchSize);
        generator.generateCircuit();
        generator.evalCircuit();
        generator.prepFiles();
        //generator.runLibsnark();
    }

}
